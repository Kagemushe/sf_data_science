# <center>**Проект-4. Задача классификации.**<center>

## *Цели проекта:*
   * Решить задачу классификации на реальных данных.

## *Задача проекта:*
   * Построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать, воспользуется он предложением об открытии депозита или нет.

## *Описание хода работы*

   * 1. ### *Знакомство с данными, обработка пропусков и выбросов*
      * Смотрим данные на предмет пропусков
      * Ищем скрытые пропущенные значения
      * Преобразуем признак balance в вещественное число. Смотрим среднее значение
      * Заменяем пропуски в признаке balance на медианное значение. Смотрим среднее значение
      * Заменяем пропуски в признаках job и education на модальные значения. Рассчитываем средний баланс клиентов для самого популярного значения работы и образования
      * Ищем выбросы в признаке balance методом Тьюки. Удаляем выбросы. Смотрим результирующие значения

   * 2. ### *Разведывательный анализ данных*
      * Смотрим число клиентов, открывших и не открывших депозит
      * Находим максимальный возраст клиента банка. Находим минимальное время разговора с клиентом банка в секундах
      * Находим месяцы, в которых проводилась маркетинговая компания. Смортим сколько сфер деятельности представлено среди клиентов банка
      * Ищем статус маркетинговой компании, для которой успех превалирует на количеством неудач
      * Находим месяц, в котором чаще всего отказывались от предложения депозита
      * Преобразуем признак возраста в категориальный. Смотрим какие возрастные группы более склонны к открытию депозита
      * Находим какая сфера деятельности наиболее популярна среди клиентов банка. Находим семейное положение, при котором, клиент наиболее склонен открывать депозит
      * Определяем с каким семейным статусом и образованием клиентов больше всего

   * 3. ### *Отбор и преобразование признаков*
      * Кодируем признак education методом LabelEncoder. Находим сумму значений признака
      * Перекодируем в бинарный вид признаки deposit, default, housing и loan. Находим стандартное отклонение признака deposit. Находим сумму среднего арифметического значения для остальных трех признаков
      * Создадим dummy-переменные для признаков job, marital, contact, month, poutcome. Смотрим на количество признаков
      * Строим матрицу корреляций. Смотрим, присутствует ли мультиколлинеарность
      * Разделяем данные на тренировочные и тестовые выборки. Смотрим на размер тестовой выборки. Находим среднее значение целевой переменной на тестовой выборке
      * Методом SelectKBest находим 15 самых значимых признаков
      * Нормализуем данные с помощью MinMaxScaler. Находим среднее арифметическое для первого предиктора из тестовой выборки

   * 4. ### *Решение задачи классификации: логистическая регрессия и решающие деревья*
      * Обучаем модель логистической регрессии. Вычисляем метрику accuracy
      * Обучаем модель решающего дерева. Находим оптимальную глубину дерева, при котором не наблюдается преобучение. Вычисляем метрику accuracy
      * Обучаем модель решающего дерева на сетке параметров с помощью GridSearch. Вычисляем метрику f1 для наилучшей комбинации параметров.

   * 5. ### *Решение задачи классификации: ансамбли моделей и построение прогноза*
      * Обучаем модель рандомного леса. Оцениваем метрики accuracy и recall
      * Обучаем модель градиентного бустинга. Оцениваем метрики
      * Обьединяем стэкингом модели решающего дерева и градиентного бустинга, в качестве метамодели берем логистическую регрессию. Оцениваем метрику precision
      * Оцениваем важность признаков в модели градиентного бустинга
      * Оптимизируем гиперпараметры с помощью Optuna. Оцениваем метрики. Наблюдаем повышение качества
